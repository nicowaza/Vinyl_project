{"version":3,"sources":["webpack:///webpack/bootstrap 7fdc7bb8d35a216900c8","webpack:///external \"mongoose\"","webpack:///external \"express\"","webpack:///external \"body-parser\"","webpack:///external \"path\"","webpack:///external \"connect-flash\"","webpack:///external \"multer\"","webpack:///./src/index.js","webpack:///external \"dotenv/config\"","webpack:///external \"volleyball\"","webpack:///external \"express-validator\"","webpack:///external \"express-session\"","webpack:///./src/routes/vinyls.js","webpack:///./src/models/vinyl.js","webpack:///./src/routes/users.js","webpack:///./src/models/user.js","webpack:///external \"express-messages\""],"names":["SERVER_PORT","DBUrl","process","env","app","express","url","options","promiseLibrary","Promise","mongoose","connect","db","connection","on","console","log","err","use","bodyParser","json","urlencoded","extended","static","set","session","secret","resave","saveUninitialized","require","req","res","next","locals","messages","path","join","__dirname","get","render","listen","vinylRouter","Router","storage","multer","diskStorage","destination","file","cb","filename","originalname","Date","now","extname","upload","post","single","body","vinyl","cover","save","flash","redirect","Vinyl","find","allVinyls","vinyls","findById","params","id","query","_id","update","delete","remove","Schema","VinylSchema","title","type","String","index","artist","release","format","description","model","userRouter","user","avatar","UserSchema","name","required","username","email","password","User"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7fdc7bb8d35a216900c8","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"connect-flash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-flash\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 5\n// module chunks = 0","import express from 'express'\nconst { SERVER_PORT, DBUrl } = process.env\nconst app = express()\nimport bodyParser from 'body-parser'\nimport \"dotenv/config\"\nimport volleyball from 'volleyball'\nimport expressValidator from 'express-validator'\nimport flash from 'connect-flash'\nimport session from 'express-session'\nimport { vinylRouter } from './routes/vinyls'\nimport { userRouter } from './routes/users'\nimport mongoose from 'mongoose'\nimport path from 'path'\n\n\n\nconst url = DBUrl\nconst options = {\n  promiseLibrary: Promise,\n  // useMongoClient: true\n}\n\nmongoose.connect(url, options)\nlet db=mongoose.connection\n// check Db connection\nmongoose.connection.on('connected', () =>\nconsole.log('[MongoDB] is running on port 27017')\n)\n\n//check for Db errors\ndb.on('error', (err) => {\n  console.log(err)\n})\n\n\napp.use(bodyParser.json())\napp.use(bodyParser.urlencoded({ extended: true}))\n\n// Set public folder\napp.use(express.static(/*path.join(__dirname, */'public'));\n\n//express session middleware\napp.set('trust proxy', 1) // trust first proxy\napp.use(session({\n  secret: 'keyboard cat',\n  resave: true,\n  saveUninitialized: true,\n}))\n\n//express messages middleware\napp.use(require('connect-flash')());\napp.use(function (req, res, next) {\n  res.locals.messages = require('express-messages')(req, res);\n  next();\n});\n\n\napp.set('views', path.join(__dirname, 'views'))\napp.set('view engine', 'pug')\n\napp.use('/users', userRouter)\n// app.use('/vinyls', vinylRouter)\napp.use('/vinyls', vinylRouter)\n\napp.get('/', (req, res) => {\n  console.log('ça marche')\n  res.render('home')\n})\n\n// app.get('/', (req, res) => {\n//   let articles = [\n//     {\n//       id: 1,\n//       title:'Article 1',\n//       author: 'Nico',\n//       body:'this is article one'\n//     },\n//     {\n//       id: 2,\n//       title:'Article 2',\n//       author: 'jojo',\n//       body:'this is article two'\n//     },\n//     {\n//       id: 3,\n//       title:'Article 3',\n//       author: 'Bobo',\n//       body:'this is article three'\n//     },\n//     {\n//       id: 4,\n//       title:'Article 4',\n//       author: 'Jo',\n//       body:'this is article four'\n//     },\n//   ]\n//   res.render('home', /*dans le render on met le nom du fichier pug dans lequel on va rendre les données. On ajoute alors un objet qui contient la clé de ce que l'on renvoie dans pug et la valeur qui y fait référence*/\n//    {\n//     title: 'Articles', /*ici on appelera la clé title dans pug et pug affichera la valeur Article*/\n//     articles:articles /*ici on appelera la clé articles dans pug et celle ci renverra la valeur articles qui est un array. Il faudra introduire dans pug un loop pour naviguer dans l'array*/\n//   })\n// })\n\n// app.get('/friends', (req, res) => {\n//   const friends = [\"tony\", \"miranda\", \"jojo\", \"pierre\", \"basil\"]\n//   res.render('friends', {friends: friends});\n// })\n\napp.listen(SERVER_PORT, () => console.log(`[Express] is running on ${SERVER_PORT}`))\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"dotenv/config\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv/config\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"volleyball\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"volleyball\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"express-validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-validator\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 11\n// module chunks = 0","import express from 'express';\nconst vinylRouter = express.Router();\nimport { Vinyl } from '../models/vinyl'\nimport multer from 'multer'\nimport path from 'path'\n\nimport bodyParser from 'body-parser'\n//création de l'espace de storage pour les files uploaded dans les formulaires add et edit\nconst storage = multer.diskStorage({\n  destination : (req, file, cb) => {\n    cb(null, './public/uploads/')\n  },\n  filename : (req, file, cb) => {\n    cb(null, file.originalname + '-' + Date.now() + path.extname(file.originalname))\n  }\n})\n\nconst upload = multer({\n  storage: storage}) /*on récupère la variable storage qui défini l'espace de stockage*/\n\n//on crée un Router pour toutes les routes ayant a trait aux vinyls\n\n// vinylRouter.get('/', /*cette route '/' correspond à '/vinyls' puisqu'on se trouve déjà dans la route vinyls*/ (req,res) => {\n//   // Vinyl.find({},(err,vinyls)=> {\n// //   //   if (err) res.send(err)\n// //   //     res.render(\"allvinyls\")\n// //   })\n// // }\n\n//Add submit POST route\nvinylRouter.post('/add_vinyls', upload.single('cover'), (req, res) => {\n  console.log(req.body)\n  console.log(req.file)\n\n  let vinyl = new Vinyl(req.body)\n    // title: req.body.title,\n    // artist: req.body.artist,\n    // release: req.body.release,\n    // format : req.body.format,\n    // description: req.body.description,\n    // cover: req.file.filename\n\n\n  if(req.file){\n    vinyl.cover=req.file.filename\n  }\n    else{\n      vinyl.cover=\"no cover\"\n    }\n\n  vinyl.save( (err, vinyl) => {\n  if(err){\n    req.flash('danger', 'Oops something went wrong')\n    res.redirect('/vinyls')\n  } else {\n    req.flash('success', 'Vinyl added') /*on utilise le type success pour la couleur bootstrap et on écrit le message a afficher*/\n    res.redirect('/vinyls')\n  }\n  })\n})\n// display add_vinyl route\nvinylRouter.get('/add_vinyls', (req, res) => {\n\n  res.render('add_vinyls');\n})\n\n\n// User collection route\n/*cette route est en fait /vinyls*/\nvinylRouter.get('/', (req, res) => {\n  Vinyl.find({}, (err, allVinyls) => {\n    res.render('profil', {\n      vinyls:allVinyls\n    });\n  })\n})\n\n// Single Item route\nvinylRouter.get('/:id', (req, res) => {\n  Vinyl.findById(req.params.id, (err, vinyl) => {\n    if(err){\n      console.log(err)\n    } else {\n    res.render('vinyl', {\n      vinyl:vinyl\n    });\n    }\n  });\n});\n\n// Formulaire Edit\nvinylRouter.get('/edit/:id', (req, res) => {\n  Vinyl.findById(req.params.id, (err, vinyl) => {\n    res.render('edit_vinyl', {\n      vinyl:vinyl\n    });\n  });\n});\n\n// Update Single Vinyl\nvinylRouter.post('/edit/:id', upload.single('cover'), (req, res) => {\n\n  let vinyl = req.body\n\nif(req.file){\n vinyl.cover=req.file.filename\n}\n else{\n   vinyl.cover=\"no cover\"\n }\n\n  let query = {_id:req.params.id};\n\n  Vinyl.update(query, vinyl, (err) => { /*ici on update le modèle du vinyl au lieu de sauver un objet*/\n  if(err){\n    console.log(err)\n  } else {\n    req.flash('success', 'Vinyl updated')\n    res.redirect('/vinyls')\n  }\n  })\n})\n\nvinylRouter.delete('/edit/:id', (req, res) => {\n\n  Vinyl.remove({_id:req.params.id}, (err) => {\n    if(err){\n      console.log(err)\n    } else {\n      req.flash('success', 'Vinyl deleted')\n      res.redirect('/profil')\n    }\n    })\n})\n\n\nexport { vinylRouter }\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/vinyls.js","import mongoose from 'mongoose'\n\nconst Schema = mongoose.Schema\n\nconst VinylSchema = new Schema({\n  title       : {type: String, index: true},\n  artist      : {type: String, index: true},\n  release     : {type: String},\n  format      : {type: String},\n  description : {type: String},\n  cover       : {type: String}\n\n})\n\nconst Vinyl = mongoose.model(\"Vinyl\", VinylSchema)\n\nexport{ Vinyl }\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/vinyl.js","import express from 'express'\nconst userRouter = express.Router()\nimport mongoose from 'mongoose'\nimport { User } from '../models/user'\nimport multer from 'multer'\nimport path from 'path'\n\nimport bodyParser from 'body-parser'\n//création de l'espace de storage pour les files uploaded dans les formulaires add et edit\nconst storage = multer.diskStorage({\n  destination : (req, file, cb) => {\n    cb(null, './public/uploads/users')\n  },\n  filename : (req, file, cb) => {\n    cb(null, file.originalname + '-' + Date.now() + path.extname(file.originalname))\n  }\n})\n\nconst upload = multer({\n  storage: storage})\n\nuserRouter.post(\"/register\", upload.single('avatar'), (req, res) => {\n  let user = new User(req.body)\n  if(req.file){\n    console.log('uploading')\n    user.avatar=req.file.filename\n  }\n    else{\n      user.avatar=\"no avatar\"\n    }\n\n  user.save((err, user) => {\n  if(err){\n    console.log(err)\n    req.flash('danger', 'Oops something went wrong')\n    res.redirect('/users/register')\n  } else {\n    console.log(user)\n    req.flash('success', 'User created') /*on utilise le type success pour la couleur bootstrap et on écrit le message a afficher*/\n    res.redirect('/users/login')\n  }\n  })\n})\n\nuserRouter.get(\"/register\", (req, res) => {\n  res.render('register', {title:'Register'})\n})\nuserRouter.get(\"/login\", (req, res) => {\n  res.render('login', {title: 'Login'})\n})\n\nexport { userRouter }\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/users.js","import mongoose from 'mongoose'\n\nconst Schema = mongoose.Schema\n\nconst UserSchema = new Schema({\n  name      : { type: String, required: true, index: true },\n  username  : { type: String, required: true, index: true },\n  email     : { type: String, required: true, index: true },\n  password  : { type: String, required: true, index: true },\n  avatar    : { type: String, index: true}\n})\n\nconst User = mongoose.model(\"User\", UserSchema)\n\nexport{User}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.js","module.exports = require(\"express-messages\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-messages\"\n// module id = 16\n// module chunks = 0"],"sourceRoot":""}